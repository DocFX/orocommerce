<% var oroshoppinglist = _.macros('oroshoppinglist') %>
<% let clipLength = 30 %>
<div class="product-item">
    <div class="grid-line-items">
        <div class="grid-line-items__row grid-line-items__row--offset-y-end">
           <%= oroshoppinglist.renderProductItemImage({
                src: obj.subData && obj.subData[0].image || obj.image,
                srcPlaceholder: obj._metadata.image_placeholder,
                productId: obj.subData && obj.subData[0].productId || productId,
                title: obj.subData && obj.subData[0].sku || sku,
                alt: name
            }) %>
        </div>
        <div class="grid-line-items__row">
            <div class="grid-line-items__row-item">
            <% let renderProductConfiguration = function(configuration) { %>
                <%= _.map(configuration, function(field) {
                    return field.label + ': <span class="bold">' + field.value + '</span>';
                }).join(', ') %>
            <% } %>
            <% if (!obj.productConfiguration) { %>
                <% if (name.length <= clipLength) { %>
                    <%= oroshoppinglist.renderProductItemName({link: link, name: name}) %>
                <% } else {%>
                <div class="grid-line-items__clip-title-container">
                    <%= oroshoppinglist.renderProductItemName({clip: true, link: link, name: name}) %>
                </div>
                <% } %>
                <% if (obj.subData) { %>
                    <% renderProductConfiguration(obj.subData[0].productConfiguration) %>
                <% } %>
            <% } else { %>
                <%- sku %><br >
                <% renderProductConfiguration(productConfiguration) %>
            <% } %>
            </div>
            <% if (note) { %>
            <div class="grid-line-items__row-item">
                <% let renderNote = function(clip) { %>
                    <div class="grid-line-items__text<%- clip ? ' grid-line-items__ellipsis' : '' %>" data-role="note"><%- note %></div>
                <% } %>
                <% if (note.length <= clipLength) { %>
                    <% renderNote() %>
                <% } else { %>
                <div class="grid-line-items__clip-text-container" data-page-component-view="oroshoppinglist/js/app/views/preview-full-note-view">
                    <div class="grid-line-items__clip-placeholder">
                        <% renderNote(true) %>
                    </div>
                </div>
                <% } %>
            </div>
            <% } %>
        </div>
    </div>
</div>
